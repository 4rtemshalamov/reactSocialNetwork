(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,a){e.exports={nav:"Navbar_nav__2xJHy",item:"Navbar_item__2DP68",activeLink:"Navbar_activeLink__3lR3f"}},123:function(e,t,a){e.exports=a.p+"static/media/user.18fc402b.jpg"},128:function(e,t,a){e.exports={preloader:"Preloader_preloader__1yqJN"}},129:function(e,t,a){e.exports={item:"Post_item__30FV7"}},157:function(e,t,a){e.exports=a(294)},23:function(e,t,a){e.exports={dialogs:"Dialogs_dialogs__2Xypf",dialogsItems:"Dialogs_dialogsItems__1YBHg",active:"Dialogs_active__36zDX",messages:"Dialogs_messages__1nOCf",message:"Dialogs_message__33tg0"}},238:function(e,t,a){},239:function(e,t,a){},24:function(e,t,a){e.exports={formControl:"FormControl_formControl__2Z5wt",error:"FormControl_error__2GmKL",formSummaryError:"FormControl_formSummaryError__2CJIa",loginBlock:"FormControl_loginBlock__PzVwl",loginFormBlock:"FormControl_loginFormBlock__1dzWE",inputBlock:"FormControl_inputBlock__16U0w",nameBlock:"FormControl_nameBlock__2XR_P",buttonLogin:"FormControl_buttonLogin__1WUWd"}},294:function(e,t,a){"use strict";a.r(t);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=a(6),n=a(8);const r=a(118).create({withCredentials:!0,baseURL:"https://social-network.samuraijs.com/api/1.0/",headers:{"API-KEY":"a8273fec-ec2f-4bbd-b971-c3b04a73c43a"}}),l={getUsers:(e=1,t=10)=>r.get("users?page=".concat(e,"&count=").concat(t)).then(e=>e.data),follow:e=>r.post("follow/".concat(e)),unfollow:e=>r.delete("follow/".concat(e)),getProfile:e=>(console.warn("Obsolete method. Please profileAPI object."),o.getProfile(e))},o={getProfile:e=>r.get("profile/"+e),getStatus:e=>r.get("profile/status/"+e),updateStatus:e=>r.put("profile/status",{status:e})},i={me:()=>r.get("auth/me"),login:(e,t,a=!1)=>r.post("auth/login",{email:e,password:t,rememberMe:a}),logout:()=>r.delete("auth/login")};let c={posts:[{id:1,message:"Hi, how are you?",likesCount:12},{id:2,message:"It's my first post",likesCount:11},{id:3,message:"Blabla",likesCount:11},{id:4,message:"Dada",likesCount:11}],newPostText:"it-kamasutra.com",profile:null,status:""};const u=e=>({type:"SET_STATUS",status:e});var m=(e=c,t)=>{switch(t.type){case"ADD-POST":{let a={id:5,message:t.newPostText,likesCount:0};return Object(n.a)({},e,{posts:[...e.posts,a],newPostText:""})}case"SET_STATUS":return Object(n.a)({},e,{status:t.status});case"SET_USER_PROFILE":return Object(n.a)({},e,{profile:t.profile});default:return e}};let d={dialogs:[{id:1,name:"Dimych"},{id:2,name:"Andrew"},{id:3,name:"Sveta"},{id:4,name:"Sasha"},{id:5,name:"Viktor"},{id:6,name:"Valera"}],messages:[{id:1,message:"Hi"},{id:2,message:"How is your it-kamasutra?"},{id:3,message:"Yo"},{id:4,message:"Yo"},{id:5,message:"Yo"}]};var p=(e=d,t)=>{switch(t.type){case"SEND_MESSAGE":let a=t.newMessageBody;return Object(n.a)({},e,{messages:[...e.messages,{id:6,message:a}]});default:return e}};let g={};var E=(e=g,t)=>e;let h={users:[],pageSize:5,totalUserCount:0,currentPage:1,isFetching:!0,followingInProgress:[]};const v=e=>({type:"TOGGLE_IS_FETCHING",isFetching:e}),_=(e,t)=>({type:"TOGGLE_IS_FOLLOWING_PROGRESS",isFetching:e,userId:t});var f=(e=h,t)=>{switch(t.type){case"FOLLOW":return Object(n.a)({},e,{users:e.users.map(e=>e.id===t.userId?Object(n.a)({},e,{followed:!0}):e)});case"UNFOLLOW":return Object(n.a)({},e,{users:e.users.map(e=>e.id===t.userId?Object(n.a)({},e,{followed:!1}):e)});case"SET_USERS":return Object(n.a)({},e,{users:t.users});case"SET_CURRENT_PAGE":return Object(n.a)({},e,{currentPage:t.currentPage});case"SET_TOTAL_USERS_COUNT":return Object(n.a)({},e,{totalUsersCount:t.count});case"TOGGLE_IS_FETCHING":return Object(n.a)({},e,{isFetching:t.isFetching});case"TOGGLE_IS_FOLLOWING_PROGRESS":return Object(n.a)({},e,{followingInProgress:t.isFetching?[...e.followingInProgress,t.userId]:e.followingInProgress.filter(e=>e!=t.userId)});default:return e}},S=a(31);let b={userId:null,email:null,login:null,isAuth:!1};const P=(e,t,a,s)=>({type:"SET_USER_DATA",payload:{userId:e,email:t,login:a,isAuth:s}}),w=()=>e=>i.me().then(t=>{if(0===t.data.resultCode){let a=t.data.data,s=a.id,n=a.login,r=a.email;e(P(s,r,n,!0))}});var C=(e=b,t)=>{switch(t.type){case"SET_USER_DATA":return Object(n.a)({},e,{},t.payload);default:return e}},O=a(119),k=a(117);let N={initialized:!1};var I=(e=N,t)=>{switch(t.type){case"INITIALIZED_SUCCESS":return Object(n.a)({},e,{initialized:!0});default:return e}};let y=Object(s.c)({profilePage:m,dialogsPage:p,sidebar:E,usersPage:f,auth:C,form:k.a,app:I}),T=Object(s.e)(y,Object(s.a)(O.a));window.store=T;var j=T,A=a(0),U=a.n(A),F=a(52),L=a.n(F),M=(a(238),a(239),a(11)),B=a.n(M),x=a(297);var D=()=>U.a.createElement("nav",{className:B.a.nav},U.a.createElement("div",{className:B.a.item},U.a.createElement(x.a,{to:"/profile",activeClassName:B.a.activeLink},"Profile")),U.a.createElement("div",{className:"".concat(B.a.item," ").concat(B.a.active)},U.a.createElement(x.a,{to:"/dialogs",activeClassName:B.a.activeLink},"Messages")),U.a.createElement("div",{className:"".concat(B.a.item," ").concat(B.a.active)},U.a.createElement(x.a,{to:"/users",activeClassName:B.a.activeLink},"Users")),U.a.createElement("div",{className:"".concat(B.a.item," ").concat(B.a.active)},U.a.createElement(x.a,{to:"/news",activeClassName:B.a.activeLink},"News")),U.a.createElement("div",{className:"".concat(B.a.item," ").concat(B.a.active)},U.a.createElement(x.a,{to:"/music",activeClassName:B.a.activeLink},"Music")),U.a.createElement("div",{className:"".concat(B.a.item," ").concat(B.a.active)},U.a.createElement("a",null,"Settings"))),z=a(122),R=a(298),G=a(23),W=a.n(G);var H=e=>{let t="/dialogs/"+e.id;return U.a.createElement("div",{className:W.a.dialog+" "+W.a.active},U.a.createElement(x.a,{to:t},e.name))};var J=e=>U.a.createElement("div",{className:W.a.dialog},e.message),V=a(295),Y=a(115),Z=a(116),q=a(58),K=a(24),X=a.n(K);const Q=e=>{e.input;let t=e.meta,a=(e.child,Object(q.a)(e,["input","meta","child"]));const s=t.touched&&t.error;return U.a.createElement("div",{className:X.a.formControl+" "+(s?X.a.error:"")},U.a.createElement("div",null,a.children),U.a.createElement("div",null,s&&U.a.createElement("span",null,t.error)))},$=e=>{const t=e.input,a=(e.meta,e.child,Object(q.a)(e,["input","meta","child"]));return U.a.createElement(Q,e,U.a.createElement("input",Object.assign({},t,a)))},ee=e=>{const t=e.input,a=(e.meta,e.child,Object(q.a)(e,["input","meta","child"]));return U.a.createElement(Q,e,U.a.createElement("input",Object.assign({},t,a)))},te=e=>{if(!e)return"Field is required"},ae=e=>t=>{if(t.length>e)return"Max length is ".concat(e," symbols")},se=ae(50),ne=Object(Z.a)({form:"dialogAddMessageForm"})(e=>U.a.createElement("form",{onSubmit:e.handleSubmit},U.a.createElement("div",null,U.a.createElement(Y.a,{component:$,validate:[te,se],name:"newMessageBody",placeholder:"Enter your message"})),U.a.createElement("div",null,U.a.createElement("button",null,"Send"))));var re=e=>{let t=e.dialogsPage,a=t.dialogs.map(e=>U.a.createElement(H,{name:e.name,key:e.id,id:e.id})),s=t.messages.map(e=>U.a.createElement(J,{message:e.message,key:e.id}));t.newMessageBody;return e.isAuth?U.a.createElement("div",{className:W.a.dialogs},U.a.createElement("div",{className:W.a.dialogsItems},a),U.a.createElement("div",{className:W.a.messages},U.a.createElement("div",null,s),U.a.createElement(ne,{onSubmit:t=>{e.sendMessage(t.newMessageBody)}}))):U.a.createElement(V.a,{to:"/login"})},le=a(7);let oe=e=>({isAuth:e.auth.isAuth});var ie=Object(s.d)(Object(le.b)(e=>({dialogsPage:e.dialogsPage,isAuth:e.auth.isAuth}),e=>({sendMessage:t=>{e((e=>({type:"SEND_MESSAGE",newMessageBody:e}))(t))}})),e=>{return Object(le.b)(oe)(class extends U.a.Component{render(){return this.props.isAuth?U.a.createElement(e,this.props):U.a.createElement(V.a,{to:"/login"})}})})(re),ce=a(79),ue=a.n(ce),me=a(123),de=a.n(me);var pe=e=>{let t=Math.ceil(e.totalUsersCount/e.pageSize),a=[];for(let s=1;s<=t;s++)a.push(s);return U.a.createElement("div",null,U.a.createElement("div",null,a.map(t=>U.a.createElement("span",{className:e.currentPage===t&&ue.a.selectedPage,onClick:a=>{e.onPageChanged(t)}},t))),e.users.map(t=>U.a.createElement("div",{key:t.id},U.a.createElement("span",null,U.a.createElement("div",null,U.a.createElement(x.a,{to:"/profile/"+t.id},U.a.createElement("img",{src:null!=t.photos.small?t.photos.small:de.a,className:ue.a.userPhoto,alt:"userPhoto"}))),U.a.createElement("div",null,t.followed?U.a.createElement("button",{disabled:e.followingInProgress.some(e=>e===t.id),onClick:()=>{e.unfollow(t.id)}},"Unfollow"):U.a.createElement("button",{disabled:e.followingInProgress.some(e=>e===t.id),onClick:()=>{e.follow(t.id)}},"Follow"))),U.a.createElement("span",null,U.a.createElement("span",null,U.a.createElement("div",null,t.name),U.a.createElement("div",null,t.status)),U.a.createElement("span",null,U.a.createElement("div",null,"u.location.country"),U.a.createElement("div",null,"u.location.city"))))))},ge=a(124),Ee=a(128),he=a.n(Ee);var ve=e=>U.a.createElement("div",{className:he.a.preloader},U.a.createElement(ge.CubeGrid,{color:"#4a76a8",size:"100px",duration:"5s"}));var _e=Object(s.d)(Object(le.b)(e=>({users:e.usersPage.users,pageSize:e.usersPage.pageSize,totalUsersCount:e.usersPage.totalUsersCount,currentPage:e.usersPage.currentPage,isFetching:e.usersPage.isFetching,followingInProgress:e.usersPage.followingInProgress}),{follow:e=>t=>{t(_(!0,e)),l.follow(e).then(a=>{0==a.data.resultCode&&t((e=>({type:"FOLLOW",userId:e}))(e)),t(_(!1,e))})},unfollow:e=>t=>{t(_(!0,e)),l.unfollow(e).then(a=>{0==a.data.resultCode&&t((e=>({type:"UNFOLLOW",userId:e}))(e)),t(_(!1,e))})},setCurrentPage:e=>({type:"SET_CURRENT_PAGE",currentPage:e}),toggleFollowingProgress:_,getUsers:(e,t)=>a=>{a(v(!0)),l.getUsers(e,t).then(e=>{a(v(!1)),a((e=>({type:"SET_USERS",users:e}))(e.items)),a((e=>({type:"SET_TOTAL_USERS_COUNT",count:e}))(e.totalCount))})}}))(class extends U.a.Component{constructor(...e){super(...e),this.onPageChanged=(e=>{this.props.getUsers(e,this.props.pageSize)})}componentDidMount(){this.props.getUsers(this.props.currentPage,this.props.pageSize)}render(){return U.a.createElement(U.a.Fragment,null,this.props.isFetching?U.a.createElement(ve,null):null,U.a.createElement(pe,{totalUsersCount:this.props.totalUsersCount,pageSize:this.props.pageSize,currentPage:this.props.currentPage,onPageChanged:this.onPageChanged,users:this.props.users,follow:this.props.follow,unfollow:this.props.unfollow,followingInProgress:this.props.followingInProgress}))}}),fe=a(73),Se=a.n(fe);var be=class extends U.a.Component{constructor(...e){super(...e),this.state={editMode:!1,status:this.props.status},this.activateEditMode=(()=>{this.setState({editMode:!0,status:this.props.status})}),this.deactivateEditMode=(()=>{this.setState({editMode:!1}),this.props.updateStatus(this.state.status)}),this.onStatusChange=(e=>{this.setState({status:e.currentTarget.value})})}componentDidUpdate(e,t,a){e.status!==this.props.status&&this.setState({status:this.props.status})}render(){return U.a.createElement("div",null,!this.state.editMode&&U.a.createElement("div",null,U.a.createElement("span",{onDoubleClick:this.activateEditMode},this.props.status||"------")),this.state.editMode&&U.a.createElement("div",null,U.a.createElement("input",{onChange:this.onStatusChange,autoFocus:!0,onBlur:this.deactivateEditMode,value:this.state.status})))}};var Pe=e=>e.profile?U.a.createElement("div",null,U.a.createElement("div",{className:Se.a.descriptionBlock},U.a.createElement("img",{src:e.profile.photos.large}),U.a.createElement(be,{status:e.status,updateStatus:e.updateStatus}))):U.a.createElement(ve,null),we=a(81),Ce=a.n(we),Oe=a(129),ke=a.n(Oe);var Ne=e=>U.a.createElement("div",{className:ke.a.item},U.a.createElement("img",{src:"https://movies4maniacs.liberty.me/wp-content/uploads/sites/1218/2015/09/avatarsucks.jpg"}),e.message,U.a.createElement("div",null,U.a.createElement("span",null,"like")," ",e.likesCount));const Ie=ae(10),ye=Object(Z.a)({form:"profileAddMessageForm"})(e=>U.a.createElement("form",{onSubmit:e.handleSubmit},U.a.createElement("div",null,U.a.createElement(Y.a,{component:$,name:"newPostText",validate:[te,Ie]})),U.a.createElement("div",null,U.a.createElement("button",null,"Add post"))));var Te=e=>{let t=e.posts.map(e=>U.a.createElement(Ne,{message:e.message,likesCount:e.likesCount}));return U.a.createElement("div",{className:Ce.a.postsBlock},U.a.createElement("h3",null,"My posts"),U.a.createElement(ye,{onSubmit:t=>{e.addPost(t.newPostText)}}),U.a.createElement("div",{className:Ce.a.posts},t))};var je=Object(le.b)(e=>({posts:e.profilePage.posts,newPostText:e.profilePage.newPostText}),e=>({addPost:t=>{e((e=>({type:"ADD-POST",newPostText:e}))(t))}}))(Te);var Ae=e=>U.a.createElement("div",null,U.a.createElement(Pe,{profile:e.profile,status:e.status,updateStatus:e.updateStatus}),U.a.createElement(je,null));var Ue=Object(s.d)(Object(le.b)(e=>({profile:e.profilePage.profile,status:e.profilePage.status,authorizedUserId:e.auth.userId,isAuth:e.auth.isAuth}),{getUserProfile:e=>t=>{l.getProfile(e).then(e=>{t((e=>({type:"SET_USER_PROFILE",profile:e}))(e.data))})},getStatus:e=>t=>{o.getStatus(e).then(e=>{t(u(e.data))})},updateStatus:e=>t=>{o.updateStatus(e).then(a=>{0===a.data.resultCode&&t(u(e))})}}),R.a)(class extends U.a.Component{componentDidMount(){let e=this.props.match.params.userId;e||(e=this.props.authorizedUserId)||this.props.history.push("/login"),this.props.getUserProfile(e),this.props.getStatus(e)}render(){return U.a.createElement(Ae,Object.assign({},this.props,{profile:this.props.profile,status:this.props.status,updateStatus:this.props.updateStatus}))}}),Fe=a(82),Le=a.n(Fe);var Me=e=>U.a.createElement("header",{className:Le.a.header},U.a.createElement("img",{src:"https://www.freelogodesign.org/Content/img/logo-ex-7.png"}),U.a.createElement("div",{className:Le.a.loginBlock},e.isAuth?U.a.createElement("div",null,e.login," - ",U.a.createElement("button",{onClick:e.logout},"Log out")):U.a.createElement(x.a,{to:"/login"},"Login")));var Be=Object(le.b)(e=>({isAuth:e.auth.isAuth,login:e.auth.login}),{logout:()=>e=>{i.logout().then(t=>{0===t.data.resultCode&&e(P(null,null,null,!1))})}})(class extends U.a.Component{render(){return U.a.createElement(Me,this.props)}});const xe=Object(Z.a)({form:"login"})(e=>U.a.createElement("div",{className:X.a.loginBlock},U.a.createElement("form",{onSubmit:e.handleSubmit,className:X.a.loginFormBlock},U.a.createElement("div",null,U.a.createElement(Y.a,{placeholder:"Email",component:ee,validate:te,name:"email"})),U.a.createElement("div",null,U.a.createElement(Y.a,{placeholder:"Password",component:ee,validate:te,name:"password",type:"password"})),U.a.createElement("div",null,U.a.createElement(Y.a,{type:"checkbox",component:"input",name:"rememberMe"})," Remember me"),e.error&&U.a.createElement("div",{className:X.a.formSummaryError},e.error),U.a.createElement("div",null,U.a.createElement("button",{className:X.a.buttonLogin},"Log in")))));var De=Object(le.b)(e=>({isAuth:e.auth.isAuth}),{login:(e,t,a)=>s=>{i.login(e,t,a).then(e=>{if(0===e.data.resultCode)s(w());else{let t=e.data.messages.length>0?e.data.messages[0]:"Some error";s(Object(S.a)("login",{_error:t}))}})}})(e=>{return e.isAuth?U.a.createElement(V.a,{to:"/profile"}):U.a.createElement("div",null,U.a.createElement("h1",{className:X.a.nameBlock},"Please enter username and password"),U.a.createElement(xe,{onSubmit:t=>{e.login(t.email,t.password,t.rememberMe)}}))});var ze=Object(s.d)(R.a,Object(le.b)(e=>({initialized:e.app.initialized}),{initializeApp:()=>e=>{let t=e(w());Promise.all([t]).then(()=>{e({type:"INITIALIZED_SUCCESS"})})}}))(class extends U.a.Component{componentDidMount(){this.props.initializeApp()}render(){return this.props.initialized?U.a.createElement("div",{className:"app-wrapper"},U.a.createElement(Be,null),U.a.createElement(D,null),U.a.createElement("div",{className:"app-wrapper-content"},U.a.createElement(z.a,{path:"/dialogs",render:()=>U.a.createElement(ie,null)}),U.a.createElement(z.a,{path:"/profile/:userId?",render:()=>U.a.createElement(Ue,null)}),U.a.createElement(z.a,{path:"/users",render:()=>U.a.createElement(_e,null)}),U.a.createElement(z.a,{path:"/login",render:()=>U.a.createElement(De,null)}))):U.a.createElement(ve,null)}}),Re=a(296);L.a.render(U.a.createElement(Re.a,null,U.a.createElement(le.a,{store:j},U.a.createElement(ze,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()})},73:function(e,t,a){e.exports={descriptionBlock:"ProfileInfo_descriptionBlock__1IM1e"}},79:function(e,t,a){e.exports={userPhoto:"users_userPhoto___Q7JB",selectedPage:"users_selectedPage__1M3vK"}},81:function(e,t,a){e.exports={postsBlock:"MyPosts_postsBlock__1VP7N",posts:"MyPosts_posts__29qZg"}},82:function(e,t,a){e.exports={header:"Header_header__IzTHf",loginBlock:"Header_loginBlock__3eT4E"}}},[[157,1,2]]]);
//# sourceMappingURL=main.8c761141.chunk.js.map